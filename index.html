<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <header>
        <p id = "playerHealth"></p>
        <p id = "opponentHealth"></p>
    </header>

    <button id="dropdownBtn">

    </button>

    <button id="head" style="background-color: gray;" onclick="tossCoinHeads()">HEAD</button>
    <button id="tail" style="background-color: white;" onclick="tossCoinTails()">TAIL</button>
    <button id="attack" style="background-color: blue;" onclick="playerAttack(); defendBtnDisable()" disabled>ATTACK</button>
    <button id="defend" style="background-color: pink;" onclick="playerDefend(); attackBtnDisable()" disabled>DEFEND</button>
    <button id="reset" style="background-color: purple;" onclick="reset()">RESET</button>

    <script>
        function toggleDropdown() {
            document.getElementById("dropdown").style.display = "block";
        }

        function attackBtnDisable(){
            var btn = document.getElementById("attack");
            btn.disabled = false;
        }

        function defendBtnDisable(){
            var btn = document.getElementById("defend");
            btn.disabled = false;
        }

        function tossCoinHeads() { //executes when the user chooses heads
            var attackBtn = document.getElementById("attack");
            var defendBtn = document.getElementById("defend")
            var headBtn = document.getElementById("head");
            var tailBtn = document.getElementById("tail");
            var coin = Math.round(Math.random());
            if (coin == 0) {
                alert("Coin is head. You chose head!");
                attackBtn.disabled = false;
                defendBtn.disabled = true;
            }
            else {
                alert("Coin is  tail. You chose head!");
                attackBtn.disabled = false;
                defendBtn.disabled = false;
            }
            var headBtn = document.getElementById("head");
            var tailBtn = document.getElementById("tail");

            headBtn.disabled = true;
            tailBtn.disabled = true;
        }

        function tossCoinTails() { //function does a coin toss if the user chooses tails
            var attackBtn = document.getElementById("attack");
            var defendBtn = document.getElementById("defend");
            var headBtn = document.getElementById("head");
            var tailBtn = document.getElementById("tail");
            var coin = Math.random();
            coin = Math.round(coin);
            if (coin == 0) {
                alert("Coin is head. You chose tails!");
                attackBtn.disabled = false;
                defendBtn.disabled = false;
            }
            else {
                alert("Coin is  tail. You chose tail!");
                attackBtn.disabled = false;
                defendBtn.disabled = true;
            }

            headBtn.disabled = true;
            tailBtn.disabled = true;
        }

        let playerHealth = 100; //sets the initial health of the player
        let opponentHealth = 100; //sets the initial health of the opponent
        let playerDamage = 0; //sets the initial damage done by the player
        let opponentDamage = 0; //sets the initial damage done by the computer

        document.getElementById("playerHealth").innerHTML = "Player HP: " + playerHealth; 
        document.getElementById("opponentHealth").innerHTML = "Opponent HP: " + opponentHealth;
            
        function calculateDamage() { //calculates the damage done by either the player or the opponent
            return Math.floor((Math.random() * 5) + 1);
        }

        function checkHealth()  { // checks the player's and opponent's health to declare either a win or loss
            if(playerHealth <= 0) { 
                document.getElementById("output").innerHTML = "Opponent Wins!"; 
            }
            else if(opponentHealth <= 0) {
                document.getElementById("output").innerHTML = "You Win!";
            }
            else {
                document.getElementById("playerHealth").innerHTML = "Player HP: " + playerHealth;
                document.getElementById("opponentHealth").innerHTML = "Opponent HP: " + opponentHealth;
            }
        }

        function playerAttack() { //is called when the player clicks the "attack" button
            alert("You will attack!");      
            var pDamage = calculateDamage(); //calculates the raw damage
            playerDamage = playerDamage + pDamage; //raw damage + damage caused by the preceding attacks

            var opponentChoice = Math.round(Math.random());  
            if (opponentChoice == 0 ) { //is executed when opponentChoice == 0 or when the opponent attacks
                var oDamage = calculateDamage(); //calculates the raw damage
                opponentDamage = opponentDamage + oDamage; //raw damage + damage caused by the preceding attacks
                alert("Player inflicts "+ pDamage +" damage");
                alert("Opponent inflicts "+ oDamage +" damage");
                playerHealth = playerHealth - oDamage;  
                opponentHealth = opponentHealth - pDamage; 
            }   
            else { //is executed when the opponent defends
                opponentDamage = 0;
                pDamage = pDamage - 3;
                if(pDamage > 0) {
                    opponentHealth = opponentHealth - pDamage; 
                    alert("Player inflicts" + pDamage + " damage");
                }   
                else {
                    alert("Opponent has completely blocked you.");
                }
            }   

            checkHealth();
        }  

        function playerDefend(){ //executes when the player clicks the "defend" button
            alert("You will defend!");
            var opponentChoice = Math.round(Math.random());
            if(opponentChoice == 0) { //executes when the opponent attacks
                var oDamage = calculateDamage(); 
                opponentDamage = opponentDamage + oDamage;
                if(oDamage > 0){ 
                    alert("Opponent inflicts "+ oDamage +" damage");
                    playerHealth = playerHealth - oDamage;
                }
                else{
                    oDamage = 0;
                    alert("You completely blocked the opponent.")
                }
            }
            else { //attacks when the opponent defends
                alert("The opponent defended too");
            }
            
            checkHealth();
        }

        function reset(){ //resets the game
            playerHealth = 100;
            opponentHealth = 100;
            playerDamage = 0;
            opponentDamage = 0;

            document.getElementById("playerHealth").innerHTML = "Player HP: " + playerHealth;
            document.getElementById("opponentHealth").innerHTML = "Opponent HP: " + opponentHealth;

            var headBtn = document.getElementById("head");
            var tailBtn = document.getElementById("tail");
            var attackBtn = document.getElementById("attack");
            var defendBtn = document.getElementById("defend");

            headBtn.disabled = false;
            tailBtn.disabled = false;
            attackBtn.disabled = true;
            defendBtn.disabled = true;
            
        }

    </script>
</body>
</html>